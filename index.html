<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PapadSale – Premium Gujarati Papads & Snacks</title>
  <meta name="description" content="Authentic homemade papads and Gujarati snacks. Fresh, handcrafted Mathiya & Chorafali delivered across India via WhatsApp ordering." />
  <link rel="icon" href="assets/logo.png" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{--brand-1:#cc5f00;--brand-2:#ff7a00;--brand-3:#ffa24d}
    *{box-sizing:border-box}
    body{font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    .gradient-bg{background:linear-gradient(135deg,var(--brand-1),var(--brand-2) 50%,var(--brand-3))}
    .professional-bg{background:linear-gradient(135deg,#f8fafc 0%,#e2e8f0 100%)}
    .card-hover{transition:transform .2s ease, box-shadow .2s ease, border-color .2s ease; border:1px solid #e2e8f0}
    .card-hover:hover{transform:translateY(-4px); box-shadow:0 20px 25px -5px rgba(0,0,0,.1),0 10px 10px -5px rgba(0,0,0,.04); border-color:#cbd5e1}
    .btn-primary{background:linear-gradient(135deg,var(--brand-2),var(--brand-1))}
    .btn-primary:hover{background:linear-gradient(135deg,#ff8c1a,#cc5f00); transform:translateY(-1px); box-shadow:0 10px 15px -3px rgba(255,122,0,.3)}
    .btn-secondary{background:linear-gradient(135deg,#10b981,#059669)}
    .btn-secondary:hover{background:linear-gradient(135deg,#34d399,#047857); transform:translateY(-1px); box-shadow:0 10px 15px -3px rgba(16,185,129,.3)}
    .text-shadow{text-shadow:0 2px 4px rgba(0,0,0,.1)}
    .professional-shadow{box-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -1px rgba(0,0,0,.06)}
    .coming-soon{position:relative}
    .coming-soon::after{content:'Coming Soon'; position:absolute; inset:auto 50% 50% auto; transform:translate(-50%, -50%); background:rgba(0,0,0,.8); color:#fff; padding:.5rem 1rem; border-radius:20px; font-size:.875rem; font-weight:600}
    .product-img{width:100%; height:12rem; object-fit:cover}
    @media (prefers-reduced-motion: reduce){*{scroll-behavior:auto}!important}
  </style>
</head>
<body class="bg-gray-50 text-gray-900">
  <a class="sr-only focus:not-sr-only focus:absolute focus:m-4 focus:rounded-md focus:bg-white focus:p-2" href="#products">Skip to products</a>

  <!-- Header -->
  <header class="gradient-bg text-white shadow-xl">
    <div class="container mx-auto px-4 py-6">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-3" aria-label="PapadSale brand">
          <img src="assets/logo.png" alt="PapadSale logo" class="w-12 h-12 rounded-lg border border-white/30" />
          <div>
            <h1 class="text-3xl font-bold text-shadow">PapadSale</h1>
            <p class="text-orange-100 text-sm font-medium">Premium Gujarati Snacks</p>
          </div>
        </div>
        <button id="menuBtn" class="md:hidden inline-flex items-center gap-2 rounded-lg border border-white/30 px-3 py-2" aria-expanded="false" aria-controls="primary-nav">
          <span>Menu</span>
          <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path d="M3 6h14M3 10h14M3 14h14" stroke="currentColor" stroke-width="2"/></svg>
        </button>
        <nav id="primary-nav" class="hidden md:flex items-center gap-6">
          <a href="#products" class="hover:text-orange-200 font-medium">Products</a>
          <a href="#about" class="hover:text-orange-200 font-medium">About</a>
          <a href="#contact" class="hover:text-orange-200 font-medium">Contact</a>
          <a href="https://wa.me/919978113276" target="_blank" rel="noopener noreferrer" class="bg-green-500 hover:bg-green-600 px-4 py-2 rounded-lg font-medium">
            WhatsApp
          </a>
        </nav>
      </div>
      <nav id="mobile-nav" class="md:hidden hidden mt-4 space-y-2">
        <a class="block bg-white/10 rounded px-3 py-2" href="#products">Products</a>
        <a class="block bg-white/10 rounded px-3 py-2" href="#about">About</a>
        <a class="block bg-white/10 rounded px-3 py-2" href="#contact">Contact</a>
      </nav>
    </div>
  </header>

  <main>
    <!-- Hero -->
    <section class="professional-bg py-16 md:py-20">
      <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto text-center">
          <h2 class="text-4xl md:text-6xl font-bold mb-6 text-shadow">સ્વાદિષ્ટ ગુજરાતી પાપડ</h2>
          <p class="text-lg md:text-xl text-gray-700 max-w-2xl mx-auto leading-relaxed">
            Authentic homemade papads and traditional Gujarati snacks crafted with time‑honored recipes.
            Experience the genuine taste of Gujarat, delivered fresh to your doorstep.
          </p>
          <div class="mt-8 flex flex-col sm:flex-row gap-4 justify-center">
            <a href="#products" class="btn-primary text-white px-6 py-3 rounded-lg font-semibold inline-block">Browse Products</a>
            <a href="https://wa.me/919978113276" target="_blank" rel="noopener noreferrer" class="btn-secondary text-white px-6 py-3 rounded-lg font-semibold inline-block">Order on WhatsApp</a>
          </div>
        </div>
      </div>
    </section>

    <!-- Products -->
    <section id="products" class="py-16 bg-white">
      <div class="container mx-auto px-4">
        <div class="text-center mb-12">
          <h2 class="text-4xl font-bold mb-3">Our Products</h2>
          <p class="text-lg text-gray-700 max-w-2xl mx-auto">Discover our range of authentic Gujarati snacks, made with traditional recipes and premium ingredients.</p>
        </div>

        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12" id="productGrid" aria-live="polite"></div>

        <!-- Combo Offers (unchanged) -->
        <div class="bg-gradient-to-r from-orange-50 to-amber-50 rounded-xl p-8 mb-8 border border-orange-100">
          <div class="text-center mb-8">
            <h3 class="text-3xl font-bold mb-1">Special Combo Offers</h3>
            <p class="text-gray-600">Save more with our carefully curated combo packages</p>
          </div>
          <div class="grid md:grid-cols-2 gap-6" id="comboGrid"></div>
        </div>
      </div>
    </section>

    <!-- Floating Cart Button -->
    <div id="cart" class="fixed bottom-6 right-6 z-50" aria-live="polite">
      <button type="button" onclick="toggleCart()" class="btn-primary text-white p-4 rounded-full shadow-lg hover:shadow-xl">
        <span class="sr-only">Open cart</span>
        <div class="flex items-center">
          <span class="text-xl" aria-hidden="true">🛒</span>
          <span id="cartCount" class="bg-red-500 text-white rounded-full px-2 py-1 text-xs ml-2 font-semibold">0</span>
        </div>
      </button>
    </div>

    <!-- Cart Modal -->
    <div id="cartModal" class="fixed inset-0 bg-black/50 z-50 hidden" role="dialog" aria-modal="true" aria-labelledby="cartTitle">
      <div class="flex items-center justify-center min-h-full p-4">
        <div class="bg-white rounded-xl max-w-md w-full max-h-[90vh] overflow-y-auto">
          <div class="p-6">
            <div class="flex justify-between items-center mb-4">
              <h3 id="cartTitle" class="text-xl font-bold">Your Cart</h3>
              <button type="button" onclick="toggleCart()" class="text-gray-500 hover:text-gray-700" aria-label="Close cart">✕</button>
            </div>
            <div id="cartItems" class="space-y-3 mb-6">
              <p class="text-gray-500 text-center py-8">Your cart is empty</p>
            </div>
            <div id="cartTotal" class="border-t pt-4 mb-4 hidden">
              <div class="flex justify-between items-center font-bold text-lg">
                <span>Total:</span>
                <span id="totalAmount">₹0</span>
              </div>
            </div>
            <button id="checkoutBtn" type="button" onclick="showCheckout()" class="w-full bg-amber-500 text-white py-3 rounded-lg font-semibold hover:bg-amber-600 hidden">
              Proceed to Checkout
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkoutModal" class="fixed inset-0 bg-black/50 z-50 hidden" role="dialog" aria-modal="true" aria-labelledby="orderTitle">
      <div class="flex items-center justify-center min-h-full p-4">
        <div class="bg-white rounded-xl max-w-md w-full">
          <div class="p-6">
            <div class="flex justify-between items-center mb-4">
              <h3 id="orderTitle" class="text-xl font-bold">Order Details</h3>
              <button type="button" onclick="hideCheckout()" class="text-gray-500 hover:text-gray-700" aria-label="Close checkout">✕</button>
            </div>
            <form id="orderForm">
              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-medium mb-1" for="customerName">Full Name *</label>
                  <input type="text" id="customerName" required autocomplete="name" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-amber-500" />
                </div>
                <div>
                  <label class="block text-sm font-medium mb-1" for="customerPhone">Phone Number *</label>
                  <input type="tel" id="customerPhone" required inputmode="tel" pattern="^(\+?91)?[6-9]\d{9}$" title="Enter a valid Indian mobile number" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-amber-500" />
                </div>
                <div>
                  <label class="block text-sm font-medium mb-1" for="customerAddress">Delivery Address *</label>
                  <textarea id="customerAddress" required rows="3" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-amber-500"></textarea>
                </div>
                <div>
                  <label class="block text-sm font-medium mb-1" for="specialInstructions">Special Instructions</label>
                  <textarea id="specialInstructions" rows="2" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="Any special delivery instructions..."></textarea>
                </div>
              </div>
              <div class="mt-6 p-4 bg-amber-50 rounded-lg">
                <h4 class="font-semibold mb-2">Order Summary</h4>
                <div id="orderSummary" class="text-sm space-y-1"></div>
                <div class="border-t mt-2 pt-2 font-bold">Total: <span id="finalTotal">₹0</span></div>
              </div>

              <!-- Payment Options -->
              <div class="mt-4 p-4 bg-gray-50 rounded-lg border">
                <h4 class="font-semibold mb-3">Pay via UPI</h4>
                <div class="flex flex-col items-center gap-3">
                  <img src="assets/qr.png" alt="UPI QR" class="w-40 h-40 object-contain" />
                  <div class="flex items-center gap-2">
                    <input id="upiId" type="text" value="9978113276@okbizaxis" readonly class="border px-3 py-2 rounded w-60 text-center">
                    <button type="button" onclick="copyUPI()" class="btn-primary text-white px-3 py-2 rounded">Copy</button>
                  </div>
                </div>
              </div>

              <button id="placeOrderBtn" type="submit" class="w-full bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 mt-4">
                📱 Place Order via WhatsApp
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- About -->
    <section id="about" class="py-16 professional-bg">
      <div class="container mx-auto px-4 max-w-5xl">
        <div class="text-center mb-12">
          <h2 class="text-4xl font-bold mb-3">About PapadSale</h2>
          <p class="text-lg text-gray-700 max-w-2xl mx-auto">We are passionate about bringing authentic Gujarati flavors to your home. Our papads and snacks are made using traditional recipes passed down through generations.</p>
        </div>
        <div class="grid md:grid-cols-2 gap-12 items-center mb-16">
          <div>
            <h3 class="text-2xl font-bold mb-3">Our Story</h3>
            <p class="text-gray-700 mb-4">Founded with a mission to preserve and share the authentic taste of Gujarat, PapadSale brings you handcrafted snacks made with the same care and attention as our grandmothers used to make.</p>
            <p class="text-gray-700">Every product is carefully prepared using premium ingredients and traditional methods, ensuring that each bite delivers the genuine flavors of Gujarati cuisine.</p>
          </div>
          <div class="bg-white rounded-xl p-8 professional-shadow">
            <h4 class="text-lg font-semibold mb-4">Why Choose Us?</h4>
            <ul class="space-y-3 text-gray-700">
              <li class="flex items-center"><span class="w-2 h-2 bg-orange-500 rounded-full mr-3"></span>Traditional family recipes</li>
              <li class="flex items-center"><span class="w-2 h-2 bg-orange-500 rounded-full mr-3"></span>Premium quality ingredients</li>
              <li class="flex items-center"><span class="w-2 h-2 bg-orange-500 rounded-full mr-3"></span>Handcrafted with care</li>
              <li class="flex items-center"><span class="w-2 h-2 bg-orange-500 rounded-full mr-3"></span>Fresh delivery guarantee</li>
            </ul>
          </div>
        </div>
        <div class="grid md:grid-cols-3 gap-8">
          <div class="text-center bg-white rounded-xl p-6 professional-shadow">
            <div class="w-16 h-16 bg-orange-100 rounded-full grid place-items-center mx-auto mb-4" aria-hidden="true"><span class="text-2xl">🏠</span></div>
            <h3 class="text-lg font-semibold mb-1">Homemade Quality</h3>
            <p class="text-gray-600 text-sm">Made with love using traditional methods</p>
          </div>
          <div class="text-center bg-white rounded-xl p-6 professional-shadow">
            <div class="w-16 h-16 bg-orange-100 rounded-full grid place-items-center mx-auto mb-4" aria-hidden="true"><span class="text-2xl">🚚</span></div>
            <h3 class="text-lg font-semibold mb-1">Fresh Delivery</h3>
            <p class="text-gray-600 text-sm">Delivered within 24–48 hours of preparation</p>
          </div>
          <div class="text-center bg-white rounded-xl p-6 professional-shadow">
            <div class="w-16 h-16 bg-orange-100 rounded-full grid place-items-center mx-auto mb-4" aria-hidden="true"><span class="text-2xl">⭐</span></div>
            <h3 class="text-lg font-semibold mb-1">Premium Quality</h3>
            <p class="text-gray-600 text-sm">Only the finest ingredients in every product</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Contact -->
    <section id="contact" class="py-16 gradient-bg text-white">
      <div class="container mx-auto px-4 max-w-4xl text-center">
        <h2 class="text-4xl font-bold mb-3 text-shadow">Contact Us</h2>
        <p class="text-xl text-orange-100 mb-10">Ready to place your order? Get in touch today!</p>
        <div class="grid md:grid-cols-2 gap-8 mb-10">
          <div class="bg-white/10 backdrop-blur-sm rounded-xl p-8 border border-white/20">
            <div class="text-3xl mb-3" aria-hidden="true">📱</div>
            <h3 class="text-xl font-semibold mb-1">WhatsApp Orders</h3>
            <p class="text-orange-100 mb-3">Quick and easy ordering via WhatsApp</p>
            <p class="text-lg font-medium"><a class="underline" href="https://wa.me/919978113276" target="_blank" rel="noopener noreferrer">+91 99781 13276</a></p>
          </div>
          <div class="bg-white/10 backdrop-blur-sm rounded-xl p-8 border border-white/20">
            <div class="text-3xl mb-3" aria-hidden="true">🚚</div>
            <h3 class="text-xl font-semibold mb-1">Delivery Info</h3>
            <p class="text-orange-100 mb-3">Fresh delivery within 24–48 hours</p>
            <p class="text-lg font-medium">Local & Nationwide</p>
          </div>
        </div>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a href="https://wa.me/919978113276" target="_blank" rel="noopener noreferrer" class="bg-green-500 hover:bg-green-600 text-white px-8 py-4 rounded-lg font-semibold text-lg inline-block">Chat on WhatsApp</a>
          <a href="tel:+919978113276" class="bg-white/20 hover:bg-white/30 text-white px-8 py-4 rounded-lg font-semibold text-lg inline-block border border-white/30">Call Now</a>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-900 text-white py-12">
    <div class="container mx-auto px-4">
      <div class="grid md:grid-cols-3 gap-8 mb-8">
        <div>
          <div class="flex items-center gap-3 mb-4">
            <img src="assets/logo.png" alt="PapadSale logo small" class="w-10 h-10 rounded-lg" />
            <h3 class="text-xl font-bold">PapadSale</h3>
          </div>
          <p class="text-gray-400 text-sm">Authentic Gujarati snacks made with traditional recipes and premium ingredients. Bringing the taste of Gujarat to your doorstep.</p>
        </div>
        <div>
          <h4 class="text-lg font-semibold mb-4">Quick Links</h4>
          <ul class="space-y-2 text-sm">
            <li><a href="#products" class="text-gray-400 hover:text-white">Products</a></li>
            <li><a href="#about" class="text-gray-400 hover:text-white">About Us</a></li>
            <li><a href="#contact" class="text-gray-400 hover:text-white">Contact</a></li>
            <li><a href="https://wa.me/919978113276" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white">WhatsApp</a></li>
          </ul>
        </div>
        <div>
          <h4 class="text-lg font-semibold mb-4">Contact Info</h4>
          <div class="space-y-2 text-sm text-gray-400">
            <p>📱 +91 99781 13276</p>
            <p>🚚 Fresh Delivery Available</p>
            <p>⏰ 24–48 Hours Delivery</p>
          </div>
        </div>
      </div>
      <div class="border-t border-gray-800 pt-8 text-center text-gray-400 text-sm">
        © <span id="year"></span> PapadSale. All rights reserved.
      </div>
    </div>
  </footer>

  <!-- Templates -->
  <template id="productCardTpl">
    <div class="bg-white rounded-xl professional-shadow overflow-hidden card-hover">
      <div class="h-48 bg-gray-100 flex items-center justify-center relative">
        <img data-img alt="" class="product-img absolute inset-0" />
      </div>
      <div class="p-6">
        <div class="flex items-center justify-between mb-2">
          <h3 class="text-xl font-bold" data-name></h3>
          <span class="text-xs font-semibold px-2 py-1 rounded-full" data-badge></span>
        </div>
        <p class="text-gray-600 mb-4 text-sm leading-relaxed" data-desc></p>
        <div class="flex flex-col gap-3">
          <div class="flex items-center gap-2">
            <label class="text-sm">Weight:</label>
            <select class="border rounded px-2 py-1" data-weight>
              <option value="500">500g</option>
              <option value="1000" selected>1kg</option>
            </select>
            <span class="ml-auto text-2xl font-bold" data-price></span>
          </div>
          <div class="flex justify-end">
            <button type="button" class="btn-primary text-white px-4 py-2 rounded-lg font-medium text-sm" data-add>
              Add to Cart
            </button>
          </div>
        </div>
      </div>
    </div>
  </template>

  <template id="comboCardTpl">
    <div class="bg-white rounded-lg p-6 professional-shadow border border-gray-100">
      <div class="flex items-center justify-between mb-3">
        <h4 class="text-xl font-bold" data-name></h4>
        <span class="bg-green-100 text-green-800 text-xs font-semibold px-2 py-1 rounded-full" data-badge></span>
      </div>
      <p class="text-gray-600 mb-4 text-sm" data-desc></p>
      <div class="flex justify-between items-center">
        <div class="flex items-center gap-2">
          <span class="text-2xl font-bold" data-price></span>
          <span class="text-lg text-gray-500 line-through" data-strike></span>
        </div>
        <button type="button" class="btn-secondary text-white px-4 py-2 rounded-lg font-medium text-sm" data-add>
          Add Combo
        </button>
      </div>
    </div>
  </template>

  <script>
    // --- Config & Helpers ---
    const fmtINR = new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR', maximumFractionDigits: 0 });
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));

    // pricePerKg in rupees
    const PRODUCTS = [
      { name: 'Aaswad Mathiya', pricePerKg: 120, tag: 'Popular', badgeClass: 'bg-blue-100 text-blue-800', img: 'mathiya1.jpg', desc: 'Crispy and flavorful traditional mathiya made with authentic spices and premium ingredients.' },
      { name: 'Aaswad Chorafali', pricePerKg: 140, tag: 'Spicy', badgeClass: 'bg-red-100 text-red-800', img: 'chorafali1.jpg', desc: 'Spicy and crunchy chorafali with a balanced blend of traditional masalas.' },
      { name: 'Papad', pricePerKg: 130, tag: 'Premium', badgeClass: 'bg-green-100 text-green-800', img: 'papad1.jpg', desc: 'Authentic Gujarati papads prepared with premium ingredients.' },
      { name: 'Khakhra', pricePerKg: null, tag: 'Soon', badgeClass: 'bg-gray-100 text-gray-600', img: 'papad1.jpg', desc: 'Traditional crispy khakhra made with authentic recipes - launching soon!', comingSoon: true },
    ];

    const COMBOS = [
      { name: 'Aaswad Combo', price: 130, strike: 140, badge: 'Save ₹10', desc: 'Aaswad Mathiya (500g) + Aaswad Chorafali (500g)' },
      { name: 'Yash Combo', price: 140, strike: 150, badge: 'Save ₹10', desc: 'Yash Mathiya (500g) + Yash Chorafali (500g)' },
    ];

    // Cart state (persisted)
    let cart = JSON.parse(localStorage.getItem('papadsale_cart')||'[]');
    const saveCart = () => localStorage.setItem('papadsale_cart', JSON.stringify(cart));

    const cartCountEl = $('#cartCount');
    const cartItemsEl = $('#cartItems');
    const cartTotalEl = $('#cartTotal');
    const checkoutBtn = $('#checkoutBtn');

    function priceForWeight(pricePerKg, grams){
      return Math.round((pricePerKg * (grams/1000)));
    }

    function renderProducts(){
      const grid = $('#productGrid');
      const tpl = $('#productCardTpl');
      grid.innerHTML = '';
      PRODUCTS.forEach(p => {
        const node = tpl.content.cloneNode(true);
        node.querySelector('[data-img]').src = p.img;
        node.querySelector('[data-img]').alt = p.name;
        node.querySelector('[data-name]').textContent = p.name;
        const badge = node.querySelector('[data-badge]');
        badge.textContent = p.tag; badge.className = `text-xs font-semibold px-2 py-1 rounded-full ${p.badgeClass}`;
        node.querySelector('[data-desc]').textContent = p.desc;

        const addBtn = node.querySelector('[data-add]');
        const weightSel = node.querySelector('[data-weight]');
        const priceEl = node.querySelector('[data-price]');

        if(p.comingSoon){
          const card = node.firstElementChild; card.classList.add('coming-soon','opacity-75');
          priceEl.textContent = 'Coming Soon';
          weightSel.disabled = true; addBtn.disabled = true; addBtn.classList.add('opacity-60','cursor-not-allowed');
        } else {
          const updatePrice = ()=> priceEl.textContent = fmtINR.format(priceForWeight(p.pricePerKg, Number(weightSel.value)));
          weightSel.addEventListener('change', updatePrice);
          updatePrice();
          addBtn.addEventListener('click', ()=> addProductToCart(p, Number(weightSel.value)));
        }
        grid.appendChild(node);
      });
    }

    function renderCombos(){
      const grid = $('#comboGrid');
      const tpl = $('#comboCardTpl');
      grid.innerHTML = '';
      COMBOS.forEach(c => {
        const node = tpl.content.cloneNode(true);
        node.querySelector('[data-name]').textContent = c.name;
        node.querySelector('[data-badge]').textContent = c.badge;
        node.querySelector('[data-desc]').textContent = c.desc;
        node.querySelector('[data-price]').textContent = fmtINR.format(c.price);
        node.querySelector('[data-strike]').textContent = fmtINR.format(c.strike);
        node.querySelector('[data-add]').addEventListener('click', ()=> addToCart(c.name, c.price, 0));
        grid.appendChild(node);
      });
    }

    function addProductToCart(product, grams){
      const price = priceForWeight(product.pricePerKg, grams);
      addToCart(`${product.name} (${grams===500?'500g':'1kg'})`, price, 1);
    }

    function addToCart(name, price, qty=1){
      const existing = cart.find(i => i.name === name);
      if(existing) existing.quantity += qty; else cart.push({ name, price, quantity: qty });
      saveCart();
      updateCartDisplay();
      showNotification(`${name} added to cart!`);
    }

    function removeFromCart(index){ cart.splice(index,1); saveCart(); updateCartDisplay(); }
    function updateQuantity(index, delta){
      const item = cart[index]; item.quantity = Math.max(0, item.quantity + delta);
      if(item.quantity===0) cart.splice(index,1); saveCart(); updateCartDisplay();
    }

    function updateCartDisplay(){
      const totalCount = cart.reduce((s,i)=>s+i.quantity,0);
      cartCountEl.textContent = totalCount;
      if(cart.length === 0){
        cartItemsEl.innerHTML = '<p class="text-gray-500 text-center py-8">Your cart is empty</p>';
        cartTotalEl.classList.add('hidden');
        checkoutBtn.classList.add('hidden');
        return;
      }
      let total = 0;
      cartItemsEl.innerHTML = cart.map((item, idx)=>{
        const itemTotal = item.price * item.quantity; total += itemTotal;
        return `
          <div class="flex justify-between items-center p-3 border rounded-lg">
            <div class="flex-1">
              <h4 class="font-medium">${item.name}</h4>
              <p class="text-sm text-gray-600">${fmtINR.format(item.price)} each</p>
            </div>
            <div class="flex items-center gap-2">
              <button type="button" onclick="updateQuantity(${idx}, -1)" class="bg-gray-200 text-gray-700 w-8 h-8 rounded-full hover:bg-gray-300" aria-label="Decrease quantity">-</button>
              <span class="w-8 text-center" aria-live="polite">${item.quantity}</span>
              <button type="button" onclick="updateQuantity(${idx}, 1)" class="bg-gray-200 text-gray-700 w-8 h-8 rounded-full hover:bg-gray-300" aria-label="Increase quantity">+</button>
            </div>
            <div class="ml-4 text-right">
              <p class="font-medium">${fmtINR.format(itemTotal)}</p>
              <button type="button" onclick="removeFromCart(${idx})" class="text-red-500 text-sm hover:text-red-700">Remove</button>
            </div>
          </div>`;
      }).join('');
      $('#totalAmount').textContent = fmtINR.format(total);
      cartTotalEl.classList.remove('hidden');
      checkoutBtn.classList.remove('hidden');
    }

    function toggleCart(){ const m = $('#cartModal'); const wasHidden = m.classList.contains('hidden'); m.classList.toggle('hidden'); document.body.classList.toggle('overflow-hidden', wasHidden); }
    function showCheckout(){ $('#cartModal').classList.add('hidden'); $('#checkoutModal').classList.remove('hidden'); document.body.classList.add('overflow-hidden'); updateOrderSummary(); }
    function hideCheckout(){ $('#checkoutModal').classList.add('hidden'); document.body.classList.remove('overflow-hidden'); }

    function updateOrderSummary(){
      const orderSummary = $('#orderSummary');
      let total = 0;
      orderSummary.innerHTML = cart.map(item => {
        const itemTotal = item.price * item.quantity; total += itemTotal;
        return `<div class=\"flex justify-between\"><span>${item.name} ×${item.quantity}</span><span>${fmtINR.format(itemTotal)}</span></div>`;
      }).join('');
      $('#finalTotal').textContent = fmtINR.format(total);
    }

    function placeOrder(e){
      e.preventDefault();
      if(cart.length === 0){ showNotification('Your cart is empty.'); return; }
      const name = $('#customerName').value.trim();
      const phoneRaw = $('#customerPhone').value.trim();
      const address = $('#customerAddress').value.trim();
      const instructions = $('#specialInstructions').value.trim();
      const phoneDigits = phoneRaw.replace(/\D/g,'');
      if(!/^((91)?[6-9]\d{9})$/.test(phoneDigits)){ showNotification('Please enter a valid Indian mobile number.'); return; }

      let total = 0;
      const orderLines = cart.map(i=>{ const t=i.price*i.quantity; total+=t; return `${i.name} ×${i.quantity} = ${fmtINR.format(t)}`; }).join('\n');

      const businessMsg = `🛒 *New Order – PapadSale*\n\n`+
        `👤 *Customer*\nName: ${name}\nPhone: +${phoneDigits.startsWith('91')?phoneDigits:'91'+phoneDigits}\nAddress: ${address}\n\n`+
        `📦 *Items*\n${orderLines}\n\n`+
        `💰 *Total:* ${fmtINR.format(total)}\n\n`+
        `📝 *Notes:* ${instructions || 'None'}\n\n`+
        `Please confirm and arrange delivery.`;

      const customerMsg = `🙏 *Thank you for your order!*\n\n`+
        `📦 *Your Order*\n${orderLines}\n\n`+
        `💰 *Total:* ${fmtINR.format(total)}\n\n`+
        `📍 *Delivery Address:* ${address}\n\n`+
        `We will contact you shortly to confirm delivery time.\n\n*PapadSale Team* 🥙`;

      const bizUrl = `https://wa.me/919978113276?text=${encodeURIComponent(businessMsg)}`;
      const customerUrl = `https://wa.me/${phoneDigits.startsWith('91')?phoneDigits:'91'+phoneDigits}?text=${encodeURIComponent(customerMsg)}`;

      window.open(bizUrl, '_blank', 'noopener,noreferrer');
      setTimeout(()=> window.open(customerUrl, '_blank', 'noopener,noreferrer'), 600);

      cart = []; saveCart(); updateCartDisplay(); hideCheckout();
      showNotification('Order placed! Check WhatsApp for confirmation.');
      $('#orderForm').reset();
    }

    function copyUPI(){
      const upi = $('#upiId'); navigator.clipboard.writeText(upi.value); showNotification('UPI ID copied: '+upi.value);
    }

    function showNotification(message){
      const n = document.createElement('div');
      n.className = 'fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50';
      n.textContent = message; document.body.appendChild(n);
      setTimeout(()=> n.remove(), 3000);
    }

    // Smooth internal link scrolling and Esc close
    $$('a[href^="#"]').forEach(a=>{
      a.addEventListener('click', (e)=>{
        const id=a.getAttribute('href'); if(id.length>1){ const t=$(id); if(t){ e.preventDefault(); t.scrollIntoView({behavior:'smooth', block:'start'});} }
      });
    });
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape'){ if(!$('#checkoutModal').classList.contains('hidden')) hideCheckout(); else if(!$('#cartModal').classList.contains('hidden')) toggleCart(); }});

    // Event bindings
    $('#orderForm').addEventListener('submit', placeOrder);
    $('#menuBtn').addEventListener('click', ()=>{
      const expanded = $('#menuBtn').getAttribute('aria-expanded') === 'true';
      $('#menuBtn').setAttribute('aria-expanded', String(!expanded));
      $('#mobile-nav').classList.toggle('hidden');
    });

    // Init
    (function init(){
      renderProducts(); renderCombos(); updateCartDisplay();
      $('#year').textContent = new Date().getFullYear();
    })();
  </script>
</body>
</html>
